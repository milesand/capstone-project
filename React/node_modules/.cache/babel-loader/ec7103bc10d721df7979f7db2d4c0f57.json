{"ast":null,"code":"import _defineProperty from \"/home/hong/PRTest/capstone-project/React/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _classCallCheck from \"/home/hong/PRTest/capstone-project/React/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/hong/PRTest/capstone-project/React/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/hong/PRTest/capstone-project/React/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/hong/PRTest/capstone-project/React/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/hong/PRTest/capstone-project/React/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/hong/PRTest/capstone-project/React/src/containers/Login.js\";\nimport React, { Component, Fragment } from \"react\";\nimport LoginForm from \"../components/LoginComponents/LoginForm\"; //로그인\n\nvar Login =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Login, _Component);\n\n  //export default : 다른 모듈에서 이 모듈을 import할 때 내보낼 대표 값\n  function Login(props) {\n    var _this;\n\n    _classCallCheck(this, Login);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Login).call(this, props));\n\n    _this.facebookLogin = function (response) {\n      var data = {\n        access_token: token,\n        social_auth: \"facebook\"\n      };\n      fetch(\"http://localhost/api/facebook\", {});\n    };\n\n    console.log('login props : ', props);\n    _this.state = {\n      username: \"\",\n      password: \"\",\n      isLoading: false\n    };\n    console.log(\"로그인 시작.\");\n    return _this;\n  } //유저 로그인 상태 체크\n\n\n  _createClass(Login, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      if (this.props.isLogin) {\n        this.props.history.push(\"/\");\n      }\n    }\n  }, {\n    key: \"valChangeControl\",\n    value: function valChangeControl(e) {\n      var target_id = e.target.id;\n      var target_val = e.target.value;\n      this.setState(_defineProperty({}, target_id, target_val));\n    } //구글 로그인 구현하기\n\n  }, {\n    key: \"googleLogin\",\n    value: function googleLogin() {\n      var _this2 = this;\n\n      var auth2 = window.gapi.auth2.getAuthInstance();\n      Promise.resolve(auth2.signIn()).then(function (googleUser) {\n        console.log(\"googleUser : \", googleUser);\n        console.log(\"near login : \", _this2.props);\n        console.log(\"google login called!!!!!\", _this2.props.username);\n        var token = googleUser.getAuthResponse(true).access_token;\n        console.log(\"token : \", token);\n        var data = {\n          access_token: token,\n          social_auth: \"google\"\n        };\n\n        var errorCheck = function errorCheck(response) {\n          if (response.hasOwnProperty('error')) {\n            throw Error(response['error']);\n          }\n\n          return response;\n        };\n\n        console.log(\"here, props : \", _this2.props);\n\n        if (token != null) {\n          fetch(\"http://localhost/api/google\", {\n            method: \"POST\",\n            headers: {\n              'Content-Type': 'application/json'\n            },\n            credentials: 'include',\n            body: JSON.stringify(data)\n          }).then(function (res) {\n            return res.json();\n          }).then(errorCheck).then(function (content) {\n            console.log('prop logout : ', _this2.props.isLogout);\n\n            _this2.props.userStateChange(true, true, content.username, content.email);\n\n            _this2.props.history.push('/');\n          }).catch(function (e) {\n            return alert(e);\n          });\n        }\n      });\n    } //페이스북 로그인\n\n  }, {\n    key: \"normalLogin\",\n\n    /*googleLogin(googleUser){\n      console.log(\"near login : \", this.props);\n      if(this.props.username==\"\"){\n        console.log(\"google login called!!!!!\", this.props.username);\n        let token=googleUser.getAuthResponse().access_token;\n        console.log(token);\n         let data={\n          access_token: token,\n          social_auth: \"google\"\n        }\n         let errorCheck= response =>{\n          if(response.hasOwnProperty('error')){\n            throw Error(response['error'])\n          }\n          return response;\n        }\n        console.log(\"here, props : \", this.props);\n        if(token!=null){\n          fetch(\"http://localhost/api/google\", {\n            method: \"POST\",\n            headers: {\n              'Content-Type' : 'application/json',\n            },\n            credentials: 'include',\n            body: JSON.stringify(data)\n          })\n          .then(res=>res.json())\n          .then(errorCheck)\n          .then(content => {\n            console.log('prop logout : ', this.props.isLogout);\n            this.props.userStateChange(true, true, content.username, content.email);\n            this.props.history.push('/');\n          }).catch(e=>alert(e))\n        }\n      }\n    }*/\n    // 일반 로그인\n    value: function normalLogin(e) {\n      var _this3 = this;\n\n      e.preventDefault();\n      var isMailAuthenticated = true;\n      var data = {\n        username: this.state.username,\n        password: this.state.password\n      };\n      this.props.toggleLoadingState();\n      console.log(\"isLoading : \", this.state.isLoading);\n      fetch(\"http://localhost/api/jwt-login\", {\n        method: \"POST\",\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        credentials: 'include',\n        body: JSON.stringify(data)\n      }).then(function (res) {\n        return res.json();\n      }).then(function (content) {\n        // 아이디와 비밀번호가 올바른지 확인하고, 맞으면 이메일 인증 여부 확인\n        if (content.hasOwnProperty('error')) {\n          if (content.hasOwnProperty('email')) {\n            isMailAuthenticated = false;\n          } else throw Error(content['error']);\n        }\n\n        console.log(\"content ? \", content);\n\n        _this3.props.userStateChange(true, isMailAuthenticated, _this3.state.username, content.email);\n\n        console.log(\"joigwegjoiwegwgweg\");\n\n        _this3.setState({\n          isLoading: true\n        });\n\n        _this3.props.toggleLoadingState();\n\n        _this3.props.history.push('/');\n      }).catch(function (error) {\n        alert(error);\n\n        _this3.props.toggleLoadingState();\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this4 = this;\n\n      return React.createElement(Fragment, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 171\n        },\n        __self: this\n      }, React.createElement(LoginForm, {\n        username: this.state.username,\n        password: this.state.password,\n        isLoading: this.props.isLoading,\n        isLogin: this.isLogin,\n        changeUsername: function changeUsername(e) {\n          return _this4.valChangeControl(e);\n        },\n        changePassword: function changePassword(e) {\n          return _this4.valChangeControl(e);\n        },\n        normalLogin: function normalLogin(e) {\n          return _this4.normalLogin(e);\n        },\n        googleLogin: function googleLogin(e) {\n          return _this4.googleLogin(e);\n        },\n        facebookLogin: function facebookLogin(e) {\n          return _this4.facebookLogin(e);\n        },\n        test: function test(e) {\n          return _this4.test(e);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 172\n        },\n        __self: this\n      }));\n    }\n  }]);\n\n  return Login;\n}(Component);\n\nexport { Login as default };","map":{"version":3,"sources":["/home/hong/PRTest/capstone-project/React/src/containers/Login.js"],"names":["React","Component","Fragment","LoginForm","Login","props","facebookLogin","response","data","access_token","token","social_auth","fetch","console","log","state","username","password","isLoading","isLogin","history","push","e","target_id","target","id","target_val","value","setState","auth2","window","gapi","getAuthInstance","Promise","resolve","signIn","then","googleUser","getAuthResponse","errorCheck","hasOwnProperty","Error","method","headers","credentials","body","JSON","stringify","res","json","content","isLogout","userStateChange","email","catch","alert","preventDefault","isMailAuthenticated","toggleLoadingState","error","valChangeControl","normalLogin","googleLogin","test"],"mappings":"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","sourcesContent":["import React, { Component, Fragment } from \"react\";\nimport LoginForm from \"../components/LoginComponents/LoginForm\";\n\n//로그인\nexport default class Login extends Component { //export default : 다른 모듈에서 이 모듈을 import할 때 내보낼 대표 값\n  constructor(props) {\n    super(props);\n    console.log('login props : ', props);\n    this.state = {\n      username: \"\",\n      password: \"\",\n      isLoading: false\n    };\n    console.log(\"로그인 시작.\");\n  }\n\n  //유저 로그인 상태 체크\n  componentDidMount() {\n    if (this.props.isLogin) {\n      this.props.history.push(\"/\");\n    }\n  }\n\n  valChangeControl(e){\n    let target_id=e.target.id;\n    let target_val=e.target.value;\n    this.setState({\n      [target_id]: target_val\n    });\n  }\n\n  //구글 로그인 구현하기\n\n  googleLogin(){\n    let auth2=window.gapi.auth2.getAuthInstance();\n    Promise.resolve(auth2.signIn())\n    .then(googleUser => {\n      console.log(\"googleUser : \", googleUser);\n      console.log(\"near login : \", this.props);\n      console.log(\"google login called!!!!!\", this.props.username);\n      let token=googleUser.getAuthResponse(true).access_token;\n      console.log(\"token : \", token);\n\n      let data={\n        access_token: token,\n        social_auth: \"google\"\n      }\n\n      let errorCheck= response =>{\n        if(response.hasOwnProperty('error')){\n          throw Error(response['error'])\n        }\n        return response;\n      }\n      console.log(\"here, props : \", this.props);\n      if(token!=null){\n        fetch(\"http://localhost/api/google\", {\n          method: \"POST\",\n          headers: {\n            'Content-Type' : 'application/json',\n          },\n          credentials: 'include',\n          body: JSON.stringify(data)\n        })\n        .then(res=>res.json())\n        .then(errorCheck)\n        .then(content => {\n          console.log('prop logout : ', this.props.isLogout);\n          this.props.userStateChange(true, true, content.username, content.email);\n          this.props.history.push('/');\n        }).catch(e=>alert(e))\n      }\n    })\n  }\n\n  //페이스북 로그인\n  facebookLogin = (response) => {\n    let data={\n      access_token: token,\n      social_auth: \"facebook\"\n    }\n    fetch(\"http://localhost/api/facebook\", {\n\n    })\n  }\n  /*googleLogin(googleUser){\n    console.log(\"near login : \", this.props);\n    if(this.props.username==\"\"){\n      console.log(\"google login called!!!!!\", this.props.username);\n      let token=googleUser.getAuthResponse().access_token;\n      console.log(token);\n\n      let data={\n        access_token: token,\n        social_auth: \"google\"\n      }\n\n      let errorCheck= response =>{\n        if(response.hasOwnProperty('error')){\n          throw Error(response['error'])\n        }\n        return response;\n      }\n      console.log(\"here, props : \", this.props);\n      if(token!=null){\n        fetch(\"http://localhost/api/google\", {\n          method: \"POST\",\n          headers: {\n            'Content-Type' : 'application/json',\n          },\n          credentials: 'include',\n          body: JSON.stringify(data)\n        })\n        .then(res=>res.json())\n        .then(errorCheck)\n        .then(content => {\n          console.log('prop logout : ', this.props.isLogout);\n          this.props.userStateChange(true, true, content.username, content.email);\n          this.props.history.push('/');\n        }).catch(e=>alert(e))\n      }\n    }\n  }*/\n\n  // 일반 로그인\n  normalLogin(e) {\n    e.preventDefault();\n    let isMailAuthenticated=true;\n    let data={\n      username: this.state.username,\n      password: this.state.password\n    }\n    \n    this.props.toggleLoadingState();\n    console.log(\"isLoading : \", this.state.isLoading);\n    fetch(\"http://localhost/api/jwt-login\", {\n      method: \"POST\",\n      headers: {\n        'Content-Type' : 'application/json',\n      },\n      credentials: 'include',\n      body: JSON.stringify(data)\n    })\n    .then(res=>res.json())\n    .then(content => {\n      // 아이디와 비밀번호가 올바른지 확인하고, 맞으면 이메일 인증 여부 확인\n      if(content.hasOwnProperty('error')){\n        if(content.hasOwnProperty('email')){\n           isMailAuthenticated=false;\n        }\n        else\n           throw Error(content['error']);\n      }\n\n      console.log(\"content ? \", content);\n      this.props.userStateChange(true, isMailAuthenticated, this.state.username, content.email);\n      console.log(\"joigwegjoiwegwgweg\");\n      this.setState({\n        isLoading: true\n      });\n      this.props.toggleLoadingState();\n      this.props.history.push('/');\n    }).catch(error=>{\n          alert(error);\n          this.props.toggleLoadingState();\n    });\n  }\n\n  render() {\n    return (\n      <Fragment>\n            <LoginForm\n                username={this.state.username}\n                password={this.state.password}\n                isLoading={this.props.isLoading}\n                isLogin={this.isLogin}\n                changeUsername={e => this.valChangeControl(e)}\n                changePassword={e => this.valChangeControl(e)}\n                normalLogin={e => this.normalLogin(e)}\n                googleLogin={e => this.googleLogin(e)}\n                facebookLogin={e => this.facebookLogin(e)}\n                test={e=>this.test(e)}\n            />\n      </Fragment>\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}